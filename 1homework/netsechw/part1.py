import pyshark
import sys

pcap = pyshark.FileCapture(sys.argv[1])

ttl = {}

for p in pcap:
    try:
        if p.ip.ttl == 64:
            ttl[p.ip.addr] = ttl[p.ip.addr] + 1
        else:
             ttl[p.ip.addr] = 1
    except:
        print('arp')

print(ttl)


#{'41': 156, 
# '37': 152, 
# '53': 152, 
# '54': 130, 
# '62': 3567, 
# '55': 147, 
# '38': 153, 
# '47': 152, 
# '45': 121, 
# '40': 137, 
# '52': 144, 
# '42': 144, 
# '51': 147, 
# '39': 148, 
# '43': 151, 
# '57': 158, 
# '46': 162, 
# '58': 150, 
# '59': 145, 
# '64': 470, 
# '56': 142, 
# '50': 126, 
# '49': 138, 
# '48': 135, 
# '44': 145, 
# '60': 1, 
# '3': 3, 
# '2': 3, 
# '1': 3, 
# '4': 3, 
# '5': 3, 
# '6': 3, 
# '7': 3, 
# '8': 3, 
# '63': 4, 
# '9': 3, 
# '10': 3, 
# '61': 1}